---
title: "Homework 2"
author: Rachel Tao
output: github_document
---

```{r setup}
library(tidyverse)
library(readxl)
```

# Problem 1

```{r}
trashwheel_df <- 
  read_xlsx(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "Mr. Trash Wheel",
    range = cell_cols("A:N")) %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(
    sports_balls = round(sports_balls),
    sports_balls = as.integer(sports_balls)
  )
```

Read precipitation data!

```{r}
precip_2018 <- 
  read_excel(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "2018 Precipitation",
    skip = 1
  ) %>% 
  janitor::clean_names() %>% 
  drop_na(month) %>% 
  mutate(year = 2018) %>% 
  relocate(year)

precip_2017 <- 
  read_excel(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "2017 Precipitation",
    skip = 1
  ) %>% 
  janitor::clean_names() %>% 
  drop_na(month) %>% 
  mutate(year = 2017) %>% 
  relocate(year)
```

Now combine annual precipitation.

```{r}
month_df <- 
  tibble(
    month = 1:12,
    month_name = month.name
  )

precip_df <- 
  bind_rows(precip_2018, precip_2017) 

month_df <- 
  left_join(precip_df, month_df, by = "month") %>% 
  select(-"month")

```

This dataset contains information from the Mr. Trashwheel trash collector in Baltimore, Maryland. As trash enters the inner harbor, the trashwheel collects that trash, and stores it in a dumpster. The dataset contains information on year, month, and trash collected, including some specific kinds of trash. There are a total of `r nrow(trashwheel_df)` rows in our final dataset. Additional data sheets include monthly precipitation data. The total precipitation in 2018 was `r   filter(month_df, year == "2018") %>% pull(total) %>% sum()`. The median number of sports balls in a dumpster in 2017 was `r filter(trashwheel_df, year == 2017) %>% pull(sports_balls) %>% median()`.

# Problem 2

Read and clean NYC subway data.

```{r}
nycsubway_df <- 
  read_csv(
    "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  select(line:entry, vending, ada) %>% 
  mutate(
    entry = 
      ifelse(entry == "YES", TRUE, FALSE),
    vending = 
      ifelse(vending == "YES", TRUE, FALSE))
```

This dataset has `r ncol(nycsubway_df)` columns and `r nrow(nycsubway_df)` rows, and includes variables line, station name, station latitude, station longitude, routes served (route1-route11), entry, entrance type, vending, and ADA compliance. For data cleaning, I used the function clean_names in the janitor package to make the column names more readable in R, I selected only the columns for variables that were relevant for this problem, and I used the mutate function and ifelse function to change the entry column from character to logical. Since a future question asks about vending, I used the same method to change the vending column from character to logical. These data are tidy.

How many distinct stations are there? How many of them are ADA compliant? What proportion of station entrances/exits without vending allow entrance?

```{r}
ada_stations <- 
  distinct(nycsubway_df, line, station_name, .keep_all = TRUE) %>% 
  filter(ada == TRUE)

no_vending <- 
  filter(nycsubway_df, vending == FALSE) %>% 
  nrow()

entry_no_vending <- 
  filter(nycsubway_df, vending == FALSE) %>% 
  filter(entry == TRUE) %>% 
  nrow()
```

There are `r nrow(distinct(nycsubway_df, line, station_name))` distinct stations, of which `r nrow(ada_stations)` are ADA compliant. The proportion of station entrances/exits without vending that allow entrance is `r entry_no_vending/no_vending`.

A train info - what do they mean by "reformat data so that route number and route name arrer distinct variables?"

# Problem 3

Read in and clean pols-month.csv

```{r}

pols_month_df <- read_csv(
  "./data/fivethirtyeight_datasets/pols-month.csv") %>% 
    separate(mon, into = c("year", "month", "day"), sep = ) %>% 
    mutate(
      month = 
        replace(month, 
                month == '01', "January"),
      month = 
        replace(month,
                month == '02', "February"),
      month =
        replace(month,
                month == '03', "March"),
      month = 
        replace(month,
                month == '04', "April"),
      month =
        replace(month,
                month == '05', "May"),
      month =
        replace(month,
                month == '06', "June"),
      month =
        replace(month,
                month == '07', "July"),
      month = 
        replace(month,
                month == '08', "August"),
      month = 
        replace(month,
                month == '09', "September"),
      month =
        replace(month,
                month == '10', "October"),
      month =
        replace(month,
                month == '11', "November"),
      month =
        replace(month,
                month == '12', "December")
        ) %>% 
  relocate(year, month, prez_gop, prez_dem) %>% 
  pivot_longer(
    prez_gop:prez_dem,
    names_to = "president",
    names_prefix = "prez_",
    values_to = "prez_value") %>%
  filter(prez_value == 1) %>% 
  select(-day, -prez_value)

```

Read in and clean snp.csv

```{r}
snp_df <- read_csv(
  "./data/fivethirtyeight_datasets/snp.csv") %>% 
  separate(date, into = c("month", "day", "year"), sep = ) %>% 
  mutate(
      month = 
        replace(month, 
                month == '1', "January"),
      month = 
        replace(month,
                month == '2', "February"),
      month =
        replace(month,
                month == '3', "March"),
      month = 
        replace(month,
                month == '4', "April"),
      month =
        replace(month,
                month == '5', "May"),
      month =
        replace(month,
                month == '6', "June"),
      month =
        replace(month,
                month == '7', "July"),
      month = 
        replace(month,
                month == '8', "August"),
      month = 
        replace(month,
                month == '9', "September"),
      month =
        replace(month,
                month == '10', "October"),
      month =
        replace(month,
                month == '11', "November"),
      month =
        replace(month,
                month == '12', "December")
        ) %>% 
  select(-day) %>% 
  relocate(year, month)
```

